This is the code form the paper in APIN.
